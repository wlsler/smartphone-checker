<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>봉황중학교 스마트폰 과의존 체크리스트</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4A90E2, #357ABD);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2em;
            margin-bottom: 10px;
        }

        .header p {
            opacity: 0.9;
            font-size: 1.1em;
        }

        .content {
            padding: 30px;
        }

        .start-form {
            text-align: center;
            padding: 40px 20px;
        }

        .input-group {
            margin: 20px 0;
            text-align: left;
            max-width: 300px;
            margin-left: auto;
            margin-right: auto;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #333;
        }

        .input-group input {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .input-group input:focus {
            outline: none;
            border-color: #4A90E2;
        }

        .btn {
            background: linear-gradient(135deg, #4A90E2, #357ABD);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 16px;
            cursor: pointer;
            transition: transform 0.2s;
            margin: 10px;
        }

        .btn:hover {
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #7ED321, #5CB85C);
        }

        .btn-danger {
            background: linear-gradient(135deg, #F5A623, #E67E22);
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: #f0f0f0;
            border-radius: 10px;
            margin: 20px 0;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #7ED321, #5CB85C);
            transition: width 0.3s ease;
            border-radius: 10px;
        }

        .day-nav {
            display: flex;
            justify-content: center;
            margin: 20px 0;
            flex-wrap: wrap;
            gap: 10px;
        }

        .day-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            border: 2px solid #ddd;
            background: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            transition: all 0.3s;
        }

        .day-btn.completed {
            background: #7ED321;
            color: white;
            border-color: #7ED321;
        }

        .day-btn.current {
            background: #4A90E2;
            color: white;
            border-color: #4A90E2;
            transform: scale(1.1);
        }

        .checklist {
            margin: 20px 0;
        }

        .checklist-item {
            display: flex;
            align-items: center;
            padding: 15px;
            margin: 10px 0;
            background: #f8f9fa;
            border-radius: 10px;
            transition: background 0.3s;
        }

        .checklist-item:hover {
            background: #e9ecef;
        }

        .checklist-item input[type="checkbox"] {
            width: 20px;
            height: 20px;
            margin-right: 15px;
            cursor: pointer;
        }

        .checklist-item label {
            flex: 1;
            cursor: pointer;
            font-size: 16px;
        }

        .diary-section {
            margin: 30px 0;
        }

        .diary-section h3 {
            margin-bottom: 15px;
            color: #333;
        }

        .diary-section textarea {
            width: 100%;
            height: 120px;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 14px;
            font-family: inherit;
            resize: vertical;
        }

        .diary-section textarea:focus {
            outline: none;
            border-color: #4A90E2;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .stat-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }

        .stat-card h4 {
            color: #666;
            margin-bottom: 10px;
        }

        .stat-card .stat-value {
            font-size: 2em;
            font-weight: bold;
            color: #4A90E2;
        }

        .hidden {
            display: none;
        }

        .completion-certificate {
            text-align: center;
            padding: 40px;
            background: linear-gradient(135deg, #FFD700, #FFA500);
            border-radius: 15px;
            margin: 20px 0;
            color: #333;
        }

        .completion-certificate h2 {
            font-size: 2.5em;
            margin-bottom: 20px;
        }

        .completion-certificate .certificate-content {
            font-size: 1.2em;
            line-height: 1.6;
        }

        @media (max-width: 600px) {
            .container {
                margin: 10px;
                border-radius: 15px;
            }
            
            .content {
                padding: 20px;
            }
            
            .header {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 1.5em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>📱 봉황중학교 스마트폰 과의존 체크리스트</h1>
            <p>건강한 디지털 생활을 위한 7일 챌린지</p>
        </div>

        <div class="content">
            <!-- 시작 화면 -->
            <div id="startScreen" class="start-form">
                <h2>🚀 챌린지 시작하기</h2>
                <p style="margin: 20px 0; color: #666;">7일간 스마트폰 사용 습관을 개선해보세요!</p>
                
                <div class="input-group">
                    <label for="studentId">학번 (4자리)</label>
                    <input type="text" id="studentId" maxlength="4" placeholder="예: 1234">
                </div>
                
                <div class="input-group">
                    <label for="studentName">이름</label>
                    <input type="text" id="studentName" placeholder="이름을 입력하세요">
                </div>
                
                <button class="btn" onclick="startChallenge()">시작하기</button>
            </div>

            <!-- 메인 대시보드 -->
            <div id="mainScreen" class="hidden">
                <div style="text-align: center; margin-bottom: 30px;">
                    <h2>안녕하세요, <span id="displayName"></span>님!</h2>
                    <p>학번: <span id="displayId"></span> | Day <span id="currentDay">1</span> / 7</p>
                </div>

                <!-- 진행률 -->
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill" style="width: 0%"></div>
                </div>
                <p style="text-align: center; margin-bottom: 20px;">전체 진행률: <span id="progressText">0%</span></p>

                <!-- 일별 네비게이션 -->
                <div class="day-nav">
                    <div class="day-btn current" onclick="selectDay(1)">1</div>
                    <div class="day-btn" onclick="selectDay(2)">2</div>
                    <div class="day-btn" onclick="selectDay(3)">3</div>
                    <div class="day-btn" onclick="selectDay(4)">4</div>
                    <div class="day-btn" onclick="selectDay(5)">5</div>
                    <div class="day-btn" onclick="selectDay(6)">6</div>
                    <div class="day-btn" onclick="selectDay(7)">7</div>
                </div>

                <!-- 체크리스트 -->
                <div class="checklist">
                    <h3>📋 Day <span id="dayTitle">1</span> 실천 체크리스트</h3>
                    <div class="checklist-item">
                        <input type="checkbox" id="check1" onchange="updateProgress()">
                        <label for="check1">식사시간에 스마트폰 사용하지 않기</label>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" id="check2" onchange="updateProgress()">
                        <label for="check2">잠들기 1시간 전 스마트폰 끄기</label>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" id="check3" onchange="updateProgress()">
                        <label for="check3">공부할 때 스마트폰을 다른 방에 두기</label>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" id="check4" onchange="updateProgress()">
                        <label for="check4">하루 스마트폰 사용시간 3시간 이하 유지하기</label>
                    </div>
                    <div class="checklist-item">
                        <input type="checkbox" id="check5" onchange="updateProgress()">
                        <label for="check5">가족/친구와 대화할 때 스마트폰 보지 않기</label>
                    </div>
                </div>

                <!-- 일기 섹션 -->
                <div class="diary-section">
                    <h3>📝 오늘의 느낀점</h3>
                    <textarea id="diaryText" placeholder="오늘 스마트폰 사용을 줄이면서 느낀 점이나 어려웠던 점을 자유롭게 작성해보세요. (최대 500자)"></textarea>
                </div>

                <!-- 버튼들 -->
                <div style="text-align: center; margin: 30px 0;">
                    <button class="btn btn-secondary" onclick="saveDay()">💾 오늘 기록 저장</button>
                    <button class="btn" onclick="showStats()">📊 전체 현황 보기</button>
                    <button class="btn btn-danger" onclick="generateReport()">📄 결과 보고서 출력</button>
                </div>
            </div>

            <!-- 통계 화면 -->
            <div id="statsScreen" class="hidden">
                <h2 style="text-align: center; margin-bottom: 30px;">📊 전체 진행 현황</h2>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <h4>전체 완료율</h4>
                        <div class="stat-value" id="totalCompletionRate">0%</div>
                    </div>
                    <div class="stat-card">
                        <h4>완료한 날</h4>
                        <div class="stat-value" id="completedDays">0일</div>
                    </div>
                    <div class="stat-card">
                        <h4>평균 실천율</h4>
                        <div class="stat-value" id="averageCompletion">0%</div>
                    </div>
                </div>

                <div id="completionCertificate" class="completion-certificate hidden">
                    <h2>🏆 축하합니다!</h2>
                    <div class="certificate-content">
                        <p><strong><span id="certName"></span></strong> 학생은</p>
                        <p>스마트폰 과의존 극복 7일 챌린지를</p>
                        <p><strong>성공적으로 완주</strong>하였습니다.</p>
                        <br>
                        <p>총 실천율: <strong><span id="certRate"></span></strong></p>
                        <p>완료 날짜: <strong><span id="certDate"></span></strong></p>
                    </div>
                </div>

                <div style="text-align: center; margin: 30px 0;">
                    <button class="btn" onclick="showMain()">🏠 메인으로 돌아가기</button>
                    <button class="btn btn-danger" onclick="generateReport()">📄 결과 보고서 출력</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        let studentData = {
            studentId: '',
            name: '',
            startDate: '',
            currentDay: 1,
            dailyRecords: Array(7).fill(null).map(() => ({
                checklist: [false, false, false, false, false],
                diary: '',
                completed: false
            }))
        };

        function startChallenge() {
            const studentId = document.getElementById('studentId').value.trim();
            const studentName = document.getElementById('studentName').value.trim();
            
            if (!studentId || studentId.length !== 4 || !/^\d{4}$/.test(studentId)) {
                alert('학번을 4자리 숫자로 정확히 입력해주세요.');
                return;
            }
            
            if (!studentName) {
                alert('이름을 입력해주세요.');
                return;
            }
            
            studentData.studentId = studentId;
            studentData.name = studentName;
            studentData.startDate = new Date().toLocaleDateString('ko-KR');
            
            document.getElementById('displayName').textContent = studentName;
            document.getElementById('displayId').textContent = studentId;
            
            document.getElementById('startScreen').classList.add('hidden');
            document.getElementById('mainScreen').classList.remove('hidden');
            
            loadDay(1);
            saveData();
        }

        function selectDay(day) {
            if (day > 7) return;
            
            studentData.currentDay = day;
            loadDay(day);
            updateDayNavigation();
        }

        function loadDay(day) {
            const record = studentData.dailyRecords[day - 1];
            
            document.getElementById('currentDay').textContent = day;
            document.getElementById('dayTitle').textContent = day;
            
            // 체크리스트 로드
            for (let i = 1; i <= 5; i++) {
                document.getElementById(`check${i}`).checked = record.checklist[i - 1];
            }
            
            // 일기 로드
            document.getElementById('diaryText').value = record.diary;
            
            updateProgress();
            updateDayNavigation();
        }

        function saveDay() {
            const day = studentData.currentDay;
            const record = studentData.dailyRecords[day - 1];
            
            // 체크리스트 저장
            for (let i = 1; i <= 5; i++) {
                record.checklist[i - 1] = document.getElementById(`check${i}`).checked;
            }
            
            // 일기 저장
            const diaryText = document.getElementById('diaryText').value;
            if (diaryText.length > 500) {
                alert('일기는 500자 이내로 작성해주세요.');
                return;
            }
            record.diary = diaryText;
            
            // 완료 여부 확인
            record.completed = record.checklist.some(checked => checked) || record.diary.trim() !== '';
            
            saveData();
            updateDayNavigation();
            updateProgress();
            
            alert(`Day ${day} 기록이 저장되었습니다!`);
        }

        function updateProgress() {
            const totalItems = 7 * 5; // 7일 × 5개 항목
            let completedItems = 0;
            
            studentData.dailyRecords.forEach(record => {
                completedItems += record.checklist.filter(checked => checked).length;
            });
            
            const progressPercent = Math.round((completedItems / totalItems) * 100);
            document.getElementById('progressFill').style.width = progressPercent + '%';
            document.getElementById('progressText').textContent = progressPercent + '%';
        }

        function updateDayNavigation() {
            const dayBtns = document.querySelectorAll('.day-btn');
            dayBtns.forEach((btn, index) => {
                const day = index + 1;
                btn.classList.remove('current', 'completed');
                
                if (day === studentData.currentDay) {
                    btn.classList.add('current');
                } else if (studentData.dailyRecords[day - 1].completed) {
                    btn.classList.add('completed');
                }
            });
        }

        function showStats() {
            const totalItems = 7 * 5;
            let completedItems = 0;
            let completedDays = 0;
            
            studentData.dailyRecords.forEach(record => {
                completedItems += record.checklist.filter(checked => checked).length;
                if (record.completed) completedDays++;
            });
            
            const totalRate = Math.round((completedItems / totalItems) * 100);
            const avgRate = completedDays > 0 ? Math.round(completedItems / completedDays) : 0;
            
            document.getElementById('totalCompletionRate').textContent = totalRate + '%';
            document.getElementById('completedDays').textContent = completedDays + '일';
            document.getElementById('averageCompletion').textContent = avgRate + '%';
            
            // 완주 증명서 표시 (80% 이상 달성 시)
            if (totalRate >= 80 && completedDays >= 5) {
                document.getElementById('certName').textContent = studentData.name;
                document.getElementById('certRate').textContent = totalRate + '%';
                document.getElementById('certDate').textContent = new Date().toLocaleDateString('ko-KR');
                document.getElementById('completionCertificate').classList.remove('hidden');
            }
            
            document.getElementById('mainScreen').classList.add('hidden');
            document.getElementById('statsScreen').classList.remove('hidden');
        }

        function showMain() {
            document.getElementById('statsScreen').classList.add('hidden');
            document.getElementById('mainScreen').classList.remove('hidden');
        }

        function generateReport() {
            const reportData = {
                student: {
                    id: studentData.studentId,
                    name: studentData.name,
                    startDate: studentData.startDate,
                    completionDate: new Date().toLocaleDateString('ko-KR')
                },
                summary: calculateSummary(),
                dailyRecords: studentData.dailyRecords.map((record, index) => ({
                    day: index + 1,
                    completedItems: record.checklist.filter(checked => checked).length,
                    diary: record.diary,
                    completion: Math.round((record.checklist.filter(checked => checked).length / 5) * 100)
                }))
            };
            
            // 새 창에서 보고서 표시
            const reportWindow = window.open('', '_blank');
            reportWindow.document.write(generateReportHTML(reportData));
            reportWindow.document.close();
        }

        function calculateSummary() {
            const totalItems = 7 * 5;
            let completedItems = 0;
            let completedDays = 0;
            
            studentData.dailyRecords.forEach(record => {
                completedItems += record.checklist.filter(checked => checked).length;
                if (record.completed) completedDays++;
            });
            
            return {
                totalCompletion: Math.round((completedItems / totalItems) * 100),
                completedDays: completedDays,
                averageDaily: completedDays > 0 ? Math.round((completedItems / completedDays) * 10) / 10 : 0
            };
        }

        function generateReportHTML(data) {
            var reportHTML = '<!DOCTYPE html>' +
                '<html lang="ko">' +
                '<head>' +
                '<meta charset="UTF-8">' +
                '<title>봉황중학교 스마트폰 과의존 체크리스트 결과 보고서</title>' +
                '<style>' +
                'body { font-family: "Malgun Gothic", sans-serif; margin: 40px; line-height: 1.6; }' +
                '.header { text-align: center; border-bottom: 2px solid #4A90E2; padding-bottom: 20px; margin-bottom: 30px; }' +
                '.summary { background: #f8f9fa; padding: 20px; border-radius: 10px; margin: 20px 0; }' +
                '.daily-record { margin: 15px 0; padding: 15px; border-left: 4px solid #4A90E2; background: #f9f9f9; }' +
                '.completion-high { color: #7ED321; font-weight: bold; }' +
                '.completion-medium { color: #F5A623; font-weight: bold; }' +
                '.completion-low { color: #D0021B; font-weight: bold; }' +
                '@media print { body { margin: 20px; } }' +
                '</style>' +
                '</head>' +
                '<body>' +
                '<div class="header">' +
                '<h1>📱 봉황중학교 스마트폰 과의존 체크리스트 결과 보고서</h1>' +
                '<p>학번: ' + data.student.id + ' | 이름: ' + data.student.name + '</p>' +
                '<p>시작일: ' + data.student.startDate + ' | 완료일: ' + data.student.completionDate + '</p>' +
                '</div>' +
                '<div class="summary">' +
                '<h2>📊 전체 요약</h2>' +
                '<p><strong>전체 완료율:</strong> ' + data.summary.totalCompletion + '%</p>' +
                '<p><strong>기록한 날:</strong> ' + data.summary.completedDays + '일 / 7일</p>' +
                '<p><strong>일평균 실천 항목:</strong> ' + data.summary.averageDaily + '개</p>' +
                '</div>' +
                '<h2>📅 일별 기록</h2>';
            
            for (var i = 0; i < data.dailyRecords.length; i++) {
                var record = data.dailyRecords[i];
                var completionClass = record.completion >= 80 ? 'completion-high' : 
                                    record.completion >= 50 ? 'completion-medium' : 'completion-low';
                
                reportHTML += '<div class="daily-record">' +
                    '<h3>Day ' + record.day + ' <span class="' + completionClass + '">(' + record.completion + '% 완료)</span></h3>' +
                    '<p><strong>실천 항목:</strong> ' + record.completedItems + '/5개</p>';
                
                if (record.diary) {
                    reportHTML += '<p><strong>느낀점:</strong> ' + record.diary + '</p>';
                } else {
                    reportHTML += '<p><em>일기 미작성</em></p>';
                }
                
                reportHTML += '</div>';
            }
            
            reportHTML += '<div style="margin-top: 40px; text-align: center; color: #666;">' +
                '<p>본 보고서는 학생의 스마트폰 사용 습관 개선 노력을 기록한 것입니다.</p>' +
                '<p>출력일: ' + new Date().toLocaleDateString('ko-KR') + ' ' + new Date().toLocaleTimeString('ko-KR') + '</p>' +
                '</div>' +
                '<script>window.onload = function() { window.print(); }<\/script>' +
                '</body>' +
                '</html>';
            
            return reportHTML;
        }

        function saveData() {
            localStorage.setItem('smartphoneCheckData', JSON.stringify(studentData));
        }

        function loadData() {
            const saved = localStorage.getItem('smartphoneCheckData');
            if (saved) {
                studentData = JSON.parse(saved);
                
                document.getElementById('displayName').textContent = studentData.name;
                document.getElementById('displayId').textContent = studentData.studentId;
                
                document.getElementById('startScreen').classList.add('hidden');
                document.getElementById('mainScreen').classList.remove('hidden');
                
                loadDay(studentData.currentDay);
                updateProgress();
            }
        }

        // 페이지 로드 시 저장된 데이터 확인
        window.onload = function() {
            loadData();
        };
    </script>
</body>
</html>